/*================================================
    DevArt EichJS Framework v1.0
    HTTP Request Module v1.2
    (c) 2021, DevArt Software Co.
    All rights reserved.
    hello@devart.lk
    https://www.devart.lk
================================================*/

function HttpRequest(e,t,i,o,a,n){function s(i,o){let a=e+"/"+i+"/"+o;t.length>0&&(a+="?");for(let e=0;e<t.length;e++)a+=t[e].Name+"="+encodeURI(t[e].Value).Replace("+","%2b")+"&";return a.substring(0,a.length-2).Trim()}function d(e,t,i,a,n,s){o||void 0===ShowLoader||ShowLoader(),$.ajax({url:s.ServiceURL+"/"+t,beforeSend:function(e){if(void 0!==s.Headers&&null!==s.Headers&&s.Headers.length>0)for(let t=0;t<s.Headers.length;t++)e.setRequestHeader(s.Headers[t].Name,s.Headers[t].Value)},type:e,cache:!1,contentType:"application/json",data:JSON.stringify(i),processData:!1,error:function(e){o||void 0===HideLoader||HideLoader(),n(e)},failure:function(e){o||void 0===HideLoader||HideLoader(),n(e)},success:function(e){o||void 0===HideLoader||HideLoader(),a(e)}})}this.ServiceURL=e,this.Headers=t,this.GlobalFail=i,this.ShowLoader=a,this.HideLoader=n,this.Silent=void 0!==o&&null!==o&&o,this.Get=function(e,t,i,o){void 0===o&&(o=this.GlobalFail),d("GET",e,t,i,o,this)},this.Post=function(e,t,i,o){void 0===o&&(o=this.GlobalFail),d("POST",e,t,i,o,this)},this.Put=function(e,t,i,o){void 0===o&&(o=this.GlobalFail),d("PUT",e,t,i,o,this)},this.Delete=function(e,t,i,o){void 0===o&&(o=this.GlobalFail),d("DELETE",e,t,i,o,this)},this.Upload=function(t,i,o,a,n){if(o.form.checkValidity()){var s=new FormData,d=o.files;for(let e=0;e<d.length;e++)s.append("files[]",d[e],d[e].name);for(let e=0;e<i.length;e++)s.append(i[e].Key,JSON.stringify(i[e].Value));var l=new XMLHttpRequest;l.open("POST",e+"/"+t,!0),l.onload=function(){let e=JSON.parse(l.response);200==l.status||204==l.status?a(e):n(e),l.abort()},l.send(s)}},this.Download=function(e,t){let i=document.createElement("iframe");i.id="FrmDevArtDownload",i.width=1,i.height=1,i.frameBorder=0,i.style="position: absolute!important; top: -100px; left: -100px; width: 1px; height: 1px; display: none!important;",i.src=s(e,t);try{document.body.removeChild(i)}catch(e){}document.body.appendChild(i)},this.Load=function(e,t,i){i.src=s(e,t)}}function HttpHeader(e,t){this.Name=e,this.Value=t}function HttpData(e,t){this.Key=e,this.Value=t}